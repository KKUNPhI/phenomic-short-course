<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Data Integration in R</title>
  <style>
    /* Reset & Base */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Poppins', 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #f0f4f8, #e0eafc);
      padding: 40px;
      color: #333;
      line-height: 1.6;
    }
    h1, h2, h3 {
      color: #222;
      margin-bottom: 20px;
    }
    h1 {
      text-align: center;
      font-size: 3em;
      background: linear-gradient(to right, #0077ff, #00c3ff);
      -webkit-background-clip: text;
      color: transparent;
      margin-bottom: 50px;
    }
    h2 {
      margin-top: 50px;
      border-left: 5px solid #0077ff;
      padding-left: 10px;
    }
    p {
      text-align: center;
      font-size: 1.2em;
      margin-bottom: 30px;
    }
    pre {
      background: #1f1f1f;
      color: #d1d5db;
      padding: 20px;
      border-radius: 8px;
      overflow-x: auto;
      font-size: 0.95em;
      margin-top: 20px;
    }
    code {
      font-family: 'Fira Code', monospace;
    }
    hr {
      border: none;
      height: 2px;
      background: linear-gradient(to right, #0077ff, #00c3ff);
      margin: 60px 0;
    }
    .home-button {
      text-align: center;
      margin: 50px 0;
    }
    button {
      background: linear-gradient(to right, #0077ff, #00c3ff);
      color: white;
      padding: 12px 30px;
      border: none;
      border-radius: 30px;
      font-size: 1.1em;
      cursor: pointer;
      transition: transform 0.3s ease;
    }
    button:hover {
      transform: scale(1.05);
      background: linear-gradient(to right, #00c3ff, #0077ff);
    }
    footer {
      margin-top: 80px;
      background: #1f1f1f;
      color: #ccc;
      text-align: center;
      padding: 20px;
      font-size: 0.9em;
    }
    footer a {
      color: #00c3ff;
      text-decoration: none;
    }
    footer a:hover {
      text-decoration: underline;
    }
    /* Responsive */
    @media (max-width: 768px) {
      body {
        padding: 20px;
      }
      h1 {
        font-size: 2.2em;
      }
    }
  </style>
</head>

<body>

<h1>Data Integration in R</h1>

<p>This tutorial covers how to perform unsupervised and supervised multi-omics data integration in R.</p>

<h2>1. Unsupervised Omic Data Integration</h2>

<h3>Install Required Packages</h3>
<pre><code>install.packages("remotes")  # if not installed
remotes::install_github("OmicsToolsLab/multiOmicsViz")  # Hypothetical repo name

if (!requireNamespace("BiocManager", quietly = TRUE))
  install.packages("BiocManager")
BiocManager::install("multiOmicsViz")

install.packages(c("ggplot2", "dplyr", "reshape2", "pheatmap", "ComplexHeatmap"))
</code></pre>

<h3>Load Libraries</h3>
<pre><code>library(multiOmicsViz)
library(dplyr)
</code></pre>

<h3>Load Omics Data</h3>
<pre><code>transcriptome <- read.csv("transcriptome_data.csv", row.names = 1)
metabolome <- read.csv("metabolome_data.csv", row.names = 1)
microbiome <- read.csv("microbiome_data.csv", row.names = 1)
metadata <- read.csv("metadata.csv")
</code></pre>

<h3>Transpose for Sample-Wise Rows</h3>
<pre><code>t_expr <- t(transcriptome)
t_metab <- t(metabolome)
t_microb <- t(microbiome)
</code></pre>

<hr>

<h2>2. Supervised Omic Data Integration</h2>

<h3>Install Required Packages</h3>
<pre><code>install.packages(c("tidyverse", "reshape2", "pheatmap", "ggplot2", "corrplot"))
BiocManager::install(c("mixOmics", "clusterProfiler", "org.Hs.eg.db", "igraph", "ggraph", "ComplexHeatmap"))
</code></pre>

<h3>Load Datasets and Preprocessing</h3>
<pre><code>expr <- read.csv("transcriptome_data.csv", row.names = 1)
metab <- read.csv("metabolome_data.csv", row.names = 1)
microb <- read.csv("microbiome_data.csv", row.names = 1)
meta <- read.csv("metadata.csv")
</code></pre>

<h3>Check for Sample Matching</h3>
<pre><code>intersect(colnames(expr), colnames(metab))
</code></pre>

<h3>Transpose Datasets</h3>
<pre><code>t_expr <- t(expr)
t_metab <- t(metab)
t_microb <- t(microb)
</code></pre>

<h3>Combine Datasets</h3>
<pre><code>multi_omics <- cbind(t_expr, t_metab, t_microb)
</code></pre>

<h3>Correlation Analysis</h3>
<pre><code>cor_matrix <- cor(multi_omics, method = "spearman")
</code></pre>

<h3>Select Highly Correlated Pairs (|correlation| ≥ 0.7)</h3>
<pre><code>library(reshape2)
cor_df <- melt(cor_matrix)
cor_df <- cor_df[abs(cor_df$value) >= 0.7 & as.character(cor_df$Var1) != as.character(cor_df$Var2), ]
</code></pre>

<h3>Build Correlation Network</h3>
<pre><code>library(igraph)
g <- graph_from_data_frame(cor_df, directed = FALSE)
plot(g)
</code></pre>

<div class="home-button">
  <button onclick="location.href='https://kkunphi.github.io/phenomic-short-course/'">Back to Home</button>
</div>

<footer>
  <p>© 2025 Khon Kaen University National Phenome Institute (KKUNPhI) | 
  <a href="https://kkunphi.github.io/Agbio2/">Visit our Facebook</a></p>
</footer>

</body>
</html>
